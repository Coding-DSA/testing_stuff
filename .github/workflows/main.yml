name: Read row from csv

on:
  push:
  workflow_dispatch:

jobs:
  run-script:
    runs-on: ubuntu-latest  # Ensure this runner is available
    environment: dev
    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Read specific row from csv
        id: read_csv_python
        run: |
          python - <<EOF
          import csv
          with open('cosmos_collection_manager.csv', 'r') as file:
              reader = csv.reader(file)
              firstrow = next(reader)
              # Write the output to the GITHUB_ENV file
              with open('/tmp/envfile', 'a') as env_file:
                  env_file.write(f'csv_row={",".join(firstrow)}\\n')
          EOF
          cat /tmp/envfile >> $GITHUB_ENV  # Append the environment file content to GITHUB_ENV

      - name: Access the Python output
        run: |
          echo "csvrow from python: ${{ env.csv_row }}"
